# Datasets in `stelfi` {#data}

Below are the data packaged within `stelfi`; later chapters use the functionality offered by `stelfi` to model these data.

```{r}
library(stelfi)
data(package = "stelfi")$result[, c("Item", "Title")]
```


## Temporal point pattern data



```{r, message=FALSE}
## load the tidyverse packages
library(tidyverse)
```

### `retweets_niwa`  {-}

In 2019 a [NIWA](https://niwa.co.nz/) scientist [found a working USB in the scat of a leopard seal](https://www.nzherald.co.nz/nz/news/article.cfm?c_id=1&objectid=12201147), they then [tweeted about it](https://twitter.com/niwa_nz/status/1092610541401587712) in the hopes of finding its owner.

```{r, echo = FALSE}
##devtools::install_github("gadenbuie/tweetrmd")
library(tweetrmd)
include_tweet("https://twitter.com/niwa_nz/status/1092610541401587712")
```

The `retweets_niwa` dataset contains the retweet timestamps for this tweet.

```{r}
data(retweets_niwa, package = "stelfi")
head(retweets_niwa)
```

```{r}
ggplot(data.frame(time = retweets_niwa), aes(x = time)) + 
  geom_histogram() + ylab("Retweet frequency") + xlab("") +
  theme_bw()

```


### `serial_uk`  {-}

[Murder UK](http://www.murderuk.com/) documents some of the UKs most infamous multiple murderer cases. The `serial_uk` dataset contains summary information about the documented cases along with approximate timeframes.

```{r}
data("serial_uk", package = "stelfi")
head(serial_uk)
```


```{r}
serial_uk %>%
  mutate(time =  paste(Date.of.first.kill, "/01", sep='')) %>%
  mutate(time = as.Date(time, "%m/%Y/%d")) %>%
  ggplot(aes(x = time)) + 
  geom_histogram() + 
  ylab("Frequency of known first kill") + 
  xlab("") + theme_bw()

```



## Spatiotemporal point pattern data



Using `maps` to create `sf` objects of country boundaries:

```{r}
us <- maps::map("usa", fill = TRUE, plot = FALSE) %>%
    sf::st_as_sf() %>%
    sf::st_make_valid()
nz <- maps::map("nz", fill = TRUE, plot = FALSE) %>%
    sf::st_as_sf() %>%
    sf::st_make_valid()
iraq <- maps::map("world", "Iraq", fill = TRUE, plot = FALSE) %>%
     sf::st_as_sf() %>%
    sf::st_make_valid()
```

### `bigfoot`  {-}

The [Bigfoot Field Researchers Organization (BFRO)](https://www.bfro.net/) documents Bigfoot (Sasquatch) sightings; some data have been [collated](https://data.world/timothyrenner/bfro-sightings-data) and packaged in `stelfi` as`bigfoot`.

```{r}
data("bigfoot", package = "stelfi")
bigfoot
```

```{r, echo = FALSE}
## needed for GDAL shipped with older Ubuntu dist
sf::st_crs(bigfoot) <- "+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0" 
```

```{r}
ggplot(bigfoot, aes(x = date)) + geom_histogram(bins = 150) +
  ylab("Frequency of Sasquatch sightings") + xlab("") +
  theme_bw()
```

```{r}
ggplot(bigfoot) +  
  geom_sf(alpha = 0.3) + 
  coord_sf() + 
  geom_sf(data = us, fill = NA) + 
  theme_classic()
```

### `ufo`  {-}


The [UFO Sightings Map](https://www.arcgis.com/apps/webappviewer/index.html?id=ddda71d5211f47e782b12f3f8d06246e) shows reports of UFO sightings in the United States; some data have been [collated](https://data.world/timothyrenner/ufo-sightings#) and packaged in `stelfi` as `ufo`.

```{r}
data("ufo", package = "stelfi")
ufo
```

```{r, echo = FALSE}
## needed for GDAL shipped with older Ubuntu dist
sf::st_crs(ufo) <- "+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0" 
```

```{r}
ggplot(ufo, aes(x = date_time)) + geom_histogram(bins = 150) +
  ylab("Frequency of UFO sightings") + xlab("") +
  theme_bw()
```

```{r}
ggplot(ufo) +  
  geom_sf(alpha = 0.1, size = 1) + 
  coord_sf() + 
  geom_sf(data = us, fill = NA) +
  theme_classic()
```

### `earthquakes`  {-}

[GeoNet Quake Search](http://quakesearch.geonet.org.nz/) catalogues New Zealand earthquake occurrence; some of these data have been and packaged in `stelfi` as `earthquakes`.

```{r}
data("earthquakes", package = "stelfi")
earthquakes
```

```{r, echo = FALSE}
## needed for GDAL shipped with older Ubuntu dist
sf::st_crs(earthquakes) <- "+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0" 
```

```{r}
ggplot(earthquakes, aes(x = origintime)) + geom_histogram(bins = 100) +
  ylab("Frequency of earthquakes") + xlab("") +
  theme_bw()
```

```{r}
ggplot(earthquakes) +  
  geom_sf(alpha = 0.1) + 
  coord_sf() + 
  geom_sf(data = nz, fill = NA) +
  theme_classic()
```

### `murders_nz`  {-}

[The Homicide Report](https://interactives.stuff.co.nz/2019/the-homicide-report/) documents homicides in New Zealand. The `murders_nz` dataset contains summary information about the documented cases.

```{r}
data("murders_nz", package = "stelfi")
murders_nz
```

```{r, echo = FALSE}
## needed for GDAL shipped with older Ubuntu dist
sf::st_crs(murders_nz) <- "+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0" 
```

```{r}
ggplot(murders_nz, aes(x = Full_date)) + geom_histogram(bins = 100) +
  ylab("Frequency of murders") + xlab("") +
  theme_bw()
```

```{r}
ggplot(murders_nz) +  
  geom_sf(alpha = 0.5) + 
  coord_sf() + 
  geom_sf(data = nz, fill = NA) +
  theme_classic()
```

### `terrorism`  {-}

[The Global Terrorism Database (GTD)](http://www.start.umd.edu/gtd/) documents information on terrorism events worldwide; some of these data have been and packaged in `stelfi` as `terrorism`.


```{r}
data("terrorism", package = "stelfi")
terrorism
```

```{r, echo = FALSE}
## needed for GDAL shipped with older Ubuntu dist
sf::st_crs(terrorism) <- "+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0" 
```

```{r}
terrorism %>%
  mutate(date = paste(iday, imonth, iyear, sep = "/")) %>%
  mutate(date = as.Date(date, "%d/%m/%Y")) %>%
  ggplot(., aes(x = date)) + geom_histogram(bins = 150) +
  ylab("Frequency of attacks") + xlab("") +
  theme_bw()
```

```{r}
ggplot(terrorism) +  
  geom_sf(alpha = 0.3) + 
  coord_sf() + 
  geom_sf(data = iraq, fill = NA) +
  theme_classic()
```

## Simulated data

### `xyt`  {-}

```{r}
data("xyt", package = "stelfi")
xyt_sf <- sf::st_as_sf(xyt)
xyt_sf
```

```{r}
ggplot(xyt_sf) + geom_sf(fill = NA) +
  theme_void()
```


### `marked`  {-}

```{r}
data(marked, package = "stelfi")
marked_sf <- sf::st_as_sf(x = marked,
                        coords = c("x", "y"))
marked_sf
```

```{r}
domain <- list(3 * cbind(c(0, 1, 1, 0, 0), c(0, 0, 1, 1, 0))) %>%
  sf::st_polygon() %>% sf::st_sfc() %>% sf::st_sf(geometry = .)

ggplot(marked_sf, aes(col = m1)) + 
  geom_sf() + labs(color = "Mark") +
  scale_color_continuous(type = "viridis") +
  geom_sf(data = domain, fill = NA, inherit.aes = FALSE) +
  theme_void()
```


### `horse_mesh` {-}

```{r}
data("horse_mesh", package = "stelfi")
horse_mesh_sf <- stelfi::mesh_2_sf(horse_mesh)
horse_mesh_sf
```

```{r}
ggplot(horse_mesh_sf) + geom_sf(fill = NA, col = "black") +
  theme_void()
```