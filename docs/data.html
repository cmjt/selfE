<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Datasets in stelfi | The R package stelfi</title>
  <meta name="description" content="Using stelfi" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Datasets in stelfi | The R package stelfi" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Using stelfi" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Datasets in stelfi | The R package stelfi" />
  
  <meta name="twitter:description" content="Using stelfi" />
  

<meta name="author" content="Any questions Charlotte M. Jones-Todd" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="key-stelfi-functions.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/twitter-widget-0.0.1/widgets.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">stelfi</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Installation</a></li>
<li class="chapter" data-level="1" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>1</b> Datasets in <code>stelfi</code></a><ul>
<li class="chapter" data-level="1.1" data-path="data.html"><a href="data.html#temporal-point-pattern-data"><i class="fa fa-check"></i><b>1.1</b> Temporal point pattern data</a><ul>
<li class="chapter" data-level="" data-path="data.html"><a href="data.html#retweets_niwa"><i class="fa fa-check"></i><code>retweets_niwa</code></a></li>
<li class="chapter" data-level="" data-path="data.html"><a href="data.html#uk_serial"><i class="fa fa-check"></i><code>uk_serial</code></a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="data.html"><a href="data.html#spatiotemporal-point-pattern-data"><i class="fa fa-check"></i><b>1.2</b> Spatiotemporal point pattern data</a><ul>
<li class="chapter" data-level="" data-path="data.html"><a href="data.html#sasquatch"><i class="fa fa-check"></i><code>sasquatch</code></a></li>
<li class="chapter" data-level="" data-path="data.html"><a href="data.html#nz_earthquakes"><i class="fa fa-check"></i><code>nz_earthquakes</code></a></li>
<li class="chapter" data-level="" data-path="data.html"><a href="data.html#nz_murders"><i class="fa fa-check"></i><code>nz_murders</code></a></li>
<li class="chapter" data-level="" data-path="data.html"><a href="data.html#iraq_terrorism"><i class="fa fa-check"></i><code>iraq_terrorism</code></a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="data.html"><a href="data.html#simulated-data"><i class="fa fa-check"></i><b>1.3</b> Simulated data</a><ul>
<li class="chapter" data-level="" data-path="data.html"><a href="data.html#xyt"><i class="fa fa-check"></i><code>xyt</code></a></li>
<li class="chapter" data-level="" data-path="data.html"><a href="data.html#marked"><i class="fa fa-check"></i><code>marked</code></a></li>
<li class="chapter" data-level="" data-path="data.html"><a href="data.html#horse_mesh"><i class="fa fa-check"></i><code>horse_mesh</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="key-stelfi-functions.html"><a href="key-stelfi-functions.html"><i class="fa fa-check"></i><b>2</b> Key <code>stelfi</code> functions</a></li>
<li class="chapter" data-level="3" data-path="hawkes.html"><a href="hawkes.html"><i class="fa fa-check"></i><b>3</b> Hawkes process</a><ul>
<li class="chapter" data-level="3.1" data-path="hawkes.html"><a href="hawkes.html#the-fit_hawkes-function"><i class="fa fa-check"></i><b>3.1</b> The <code>fit_hawkes()</code> function</a><ul>
<li class="chapter" data-level="3.1.1" data-path="hawkes.html"><a href="hawkes.html#fitting-a-hawkes-model"><i class="fa fa-check"></i><b>3.1.1</b> Fitting a Hawkes model</a></li>
<li class="chapter" data-level="3.1.2" data-path="hawkes.html"><a href="hawkes.html#fitting-an-etas-type-marked-model"><i class="fa fa-check"></i><b>3.1.2</b> Fitting an ETAS-type marked model</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="hawkes.html"><a href="hawkes.html#the-fit_mhawkes-function"><i class="fa fa-check"></i><b>3.2</b> The <code>fit_mhawkes()</code> function</a></li>
<li class="chapter" data-level="3.3" data-path="hawkes.html"><a href="hawkes.html#the-fit_hawkes_cbf-function"><i class="fa fa-check"></i><b>3.3</b> The <code>fit_hawkes_cbf()</code> function</a><ul>
<li class="chapter" data-level="3.3.1" data-path="hawkes.html"><a href="hawkes.html#fitting-an-inhomogenous-hawkes-process"><i class="fa fa-check"></i><b>3.3.1</b> Fitting an inhomogenous Hawkes process</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="hawkes.html"><a href="hawkes.html#the-sim_hawkes-function"><i class="fa fa-check"></i><b>3.4</b> The <code>sim_hawkes()</code> function</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lgcp.html"><a href="lgcp.html"><i class="fa fa-check"></i><b>4</b> Log-Gaussian Cox process</a><ul>
<li class="chapter" data-level="4.1" data-path="lgcp.html"><a href="lgcp.html#the-fit_lgcp-function"><i class="fa fa-check"></i><b>4.1</b> The <code>fit_lgcp()</code> function</a><ul>
<li class="chapter" data-level="4.1.1" data-path="lgcp.html"><a href="lgcp.html#fitting-a-spatial-only-lgcp"><i class="fa fa-check"></i><b>4.1.1</b> Fitting a spatial only LGCP</a></li>
<li class="chapter" data-level="4.1.2" data-path="lgcp.html"><a href="lgcp.html#spatiotemporal-lgcp"><i class="fa fa-check"></i><b>4.1.2</b> Spatiotemporal LGCP</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="lgcp.html"><a href="lgcp.html#the-sim_lgcp-function"><i class="fa fa-check"></i><b>4.2</b> The <code>sim_lgcp()</code> function</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="fit-marked.html"><a href="fit-marked.html"><i class="fa fa-check"></i><b>5</b> Marked log-Gaussian Cox process</a><ul>
<li class="chapter" data-level="5.1" data-path="fit-marked.html"><a href="fit-marked.html#the-fit_mlgcp-function"><i class="fa fa-check"></i><b>5.1</b> The <code>fit_mlgcp()</code> function</a><ul>
<li class="chapter" data-level="5.1.1" data-path="fit-marked.html"><a href="fit-marked.html#fitting-a-marked-lgcp"><i class="fa fa-check"></i><b>5.1.1</b> Fitting a marked LGCP</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="stelfi.html"><a href="stelfi.html"><i class="fa fa-check"></i><b>6</b> Spatiotemporal self-exciting models</a><ul>
<li class="chapter" data-level="6.1" data-path="stelfi.html"><a href="stelfi.html#the-fit_stelfi-function"><i class="fa fa-check"></i><b>6.1</b> The <code>fit_stelfi()</code> function</a><ul>
<li class="chapter" data-level="6.1.1" data-path="stelfi.html"><a href="stelfi.html#spatiotemporal-hawkes-process"><i class="fa fa-check"></i><b>6.1.1</b> Spatiotemporal Hawkes process</a></li>
<li class="chapter" data-level="6.1.2" data-path="stelfi.html"><a href="stelfi.html#including-a-random-field"><i class="fa fa-check"></i><b>6.1.2</b> Including a random field</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="meshmetrics.html"><a href="meshmetrics.html"><i class="fa fa-check"></i><b>7</b> Delaunay triangulation metrics</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The <code>R</code> package <code>stelfi</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data" class="section level1 hasAnchor">
<h1><span class="header-section-number">Chapter 1</span> Datasets in <code>stelfi</code><a href="data.html#data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Below are the data packaged within <code>stelfi</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">library</span>(stelfi)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">data</span>(<span class="dt">package =</span> <span class="st">&quot;stelfi&quot;</span>)<span class="op">$</span>result[, <span class="kw">c</span>(<span class="st">&quot;Item&quot;</span>, <span class="st">&quot;Title&quot;</span>)]</a></code></pre></div>
<pre><code>##       Item             Title                                                  
##  [1,] &quot;horse_mesh&quot;     &quot;Example Delaunay triangulation&quot;                       
##  [2,] &quot;horse_sf&quot;       &quot;Example &#39;sf&#39; &#39;POLYGON&#39;&quot;                               
##  [3,] &quot;iraq_terrorism&quot; &quot;Terrorism in Iraq, 2013 - 2017&quot;                       
##  [4,] &quot;marked&quot;         &quot;Example marked point pattern data set&quot;                
##  [5,] &quot;nz_earthquakes&quot; &quot;Earthquakes in Canterbury, NZ, 2010 - 2014&quot;           
##  [6,] &quot;nz_murders&quot;     &quot;Murders of NZ, 2004 - 2019&quot;                           
##  [7,] &quot;retweets_niwa&quot;  &quot;Retweets of NIWA&#39;s viral leopard seal Tweet&quot;          
##  [8,] &quot;sasquatch&quot;      &quot;Sasquatch (bigfoot) sightings in the USA, 2000 - 2005&quot;
##  [9,] &quot;uk_serial&quot;      &quot;Serial killers of the UK, 1828 - 2015&quot;                
## [10,] &quot;xyt&quot;            &quot;Self-exciting point pattern&quot;</code></pre>
<div id="temporal-point-pattern-data" class="section level2 hasAnchor">
<h2><span class="header-section-number">1.1</span> Temporal point pattern data<a href="data.html#temporal-point-pattern-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co">## load the tidyverse packages</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<div id="retweets_niwa" class="section level3 unnumbered hasAnchor">
<h3><code>retweets_niwa</code><a href="data.html#retweets_niwa" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In 2019 a <a href="https://niwa.co.nz/">NIWA</a> scientist <a href="https://www.nzherald.co.nz/nz/news/article.cfm?c_id=1&amp;objectid=12201147">found a working USB in the scat of a leopard seal</a>, they then <a href="https://twitter.com/niwa_nz/status/1092610541401587712">tweeted about it</a> in the hopes of finding its owner. In <a href="hawkes.html#hawkes">this chapter</a> a Hawkes process is fitted to these data.</p>
<blockquote class="twitter-tweet" data-width="550" data-lang="en" data-dnt="true" data-theme="light"><p lang="en" dir="ltr">NIWA is searching for the owner of a USB stick found in the poo of a leopard seal… <br>Recognise this video? Scientists analysing the scat of leopard seals have come across an unexpected discovery – a USB stick full of photos &amp; still in working order!  <a href="https://t.co/2SZVkm5az4">https://t.co/2SZVkm5az4</a> <a href="https://t.co/JLEC8vuHH0">pic.twitter.com/JLEC8vuHH0</a></p>&mdash; NIWA (@niwa_nz) <a href="https://twitter.com/niwa_nz/status/1092610541401587712?ref_src=twsrc%5Etfw">February 5, 2019</a></blockquote>

<p>The <code>retweets_niwa</code> dataset contains the retweet timestamps for this tweet.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">data</span>(retweets_niwa, <span class="dt">package =</span> <span class="st">&quot;stelfi&quot;</span>)</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">head</span>(retweets_niwa)</a></code></pre></div>
<pre><code>## [1] &quot;2019-02-07 06:50:08 UTC&quot; &quot;2019-02-07 06:50:08 UTC&quot;
## [3] &quot;2019-02-07 06:49:22 UTC&quot; &quot;2019-02-07 06:48:48 UTC&quot;
## [5] &quot;2019-02-07 06:47:52 UTC&quot; &quot;2019-02-07 06:47:42 UTC&quot;</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(<span class="dt">time =</span> retweets_niwa), <span class="kw">aes</span>(<span class="dt">x =</span> time)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Retweet frequency&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="docs_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="uk_serial" class="section level3 unnumbered hasAnchor">
<h3><code>uk_serial</code><a href="data.html#uk_serial" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="http://www.murderuk.com/">Murder UK</a> documents some of the UKs most infamous multiple murderer cases. The <code>uk_serial</code> dataset contains summary information about the documented cases along with approximate timeframes.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">data</span>(<span class="st">&quot;uk_serial&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;stelfi&quot;</span>)</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw">head</span>(uk_serial)</a></code></pre></div>
<pre><code>##   number_of_kills       years                           name                aka
## 1             300 1995 - 1998             Dr. Harold Shipman          Dr. Death
## 2             160 1949 - 1983          Dr. John Bodkin Adams                   
## 3              26        1978                 Peter Dinsdale          Bruce Lee
## 4              21 1865 - 1872                Mary Ann Cotton                   
## 5              16        1828 William Burke and William Hare     Body Snatchers
## 6              15 1944 - 1948              John George Haigh Acid Bath Murderer
##   year_start year_end date_of_first_kill population_million
## 1       1995     1998            03/1995              58.02
## 2       1949     1983            08/1949              50.32
## 3       1973       NA            06/1973              56.19
## 4       1865     1872            01/1865              24.36
## 5       1828       NA            02/1828              15.73
## 6       1944     1948            09/1944              49.02</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">uk_serial <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">time =</span>  <span class="kw">paste</span>(date_of_first_kill, <span class="st">&quot;/01&quot;</span>, <span class="dt">sep=</span><span class="st">&#39;&#39;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">time =</span> <span class="kw">as.Date</span>(time, <span class="st">&quot;%m/%Y/%d&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Frequency of known first kill&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="docs_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
</div>
<div id="spatiotemporal-point-pattern-data" class="section level2 hasAnchor">
<h2><span class="header-section-number">1.2</span> Spatiotemporal point pattern data<a href="data.html#spatiotemporal-point-pattern-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Using <code>maps</code> to create <code>sf</code> objects of country boundaries:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">us &lt;-<span class="st"> </span>maps<span class="op">::</span><span class="kw">map</span>(<span class="st">&quot;usa&quot;</span>, <span class="dt">fill =</span> <span class="ot">TRUE</span>, <span class="dt">plot =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="st">    </span>sf<span class="op">::</span><span class="kw">st_as_sf</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="st">    </span>sf<span class="op">::</span><span class="kw">st_make_valid</span>()</a>
<a class="sourceLine" id="cb12-4" title="4">nz &lt;-<span class="st"> </span>maps<span class="op">::</span><span class="kw">map</span>(<span class="st">&quot;nz&quot;</span>, <span class="dt">fill =</span> <span class="ot">TRUE</span>, <span class="dt">plot =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="st">    </span>sf<span class="op">::</span><span class="kw">st_as_sf</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="st">    </span>sf<span class="op">::</span><span class="kw">st_make_valid</span>()</a>
<a class="sourceLine" id="cb12-7" title="7">iraq &lt;-<span class="st"> </span>maps<span class="op">::</span><span class="kw">map</span>(<span class="st">&quot;world&quot;</span>, <span class="st">&quot;Iraq&quot;</span>, <span class="dt">fill =</span> <span class="ot">TRUE</span>, <span class="dt">plot =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="st">     </span>sf<span class="op">::</span><span class="kw">st_as_sf</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-9" title="9"><span class="st">    </span>sf<span class="op">::</span><span class="kw">st_make_valid</span>()</a></code></pre></div>
<div id="sasquatch" class="section level3 unnumbered hasAnchor">
<h3><code>sasquatch</code><a href="data.html#sasquatch" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <a href="https://www.bfro.net/">Bigfoot Field Researchers Organization (BFRO)</a> documents Bigfoot (Sasquatch) sightings; some data have been <a href="https://data.world/timothyrenner/bfro-sightings-data">collated</a> and packaged in <code>stelfi</code> as<code>sasquatch</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">data</span>(<span class="st">&quot;sasquatch&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;stelfi&quot;</span>)</a>
<a class="sourceLine" id="cb13-2" title="2">sasquatch</a></code></pre></div>
<pre><code>## Simple feature collection with 972 features and 27 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: -124.5301 ymin: 25.84875 xmax: -70.75587 ymax: 48.9058
## CRS:           +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
## # A tibble: 972 × 28
##    observed  locat…¹ county state season title date       number class…² geohash
##  * &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;date&gt;      &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  
##  1 &quot;For the… This l… Shann… Sout… Fall   Repo… 2002-12-04   5173 Class A 9xxntv…
##  2 &quot;My fami… East o… Wayne… New … Fall   Repo… 2003-09-20  26566 Class A dr9q4m…
##  3 &quot;While t… Ward C… Ward … Nort… Spring Repo… 2000-04-21    751 Class A c8xfw2…
##  4 &quot;(Please… &lt;NA&gt;    Mount… Nort… Winter Repo… 2004-02-22   8165 Class A c8qzwb…
##  5 &quot;I was c… forest… Warre… New … Summer Repo… 2005-12-21  13276 Class B dr4xfu…
##  6 &quot;My summ… We wer… Taos … New … Spring Repo… 2000-05-17   4904 Class B 9wt01q…
##  7 &quot;On Aug … From G… McLea… Nort… Summer Repo… 2005-08-27  12562 Class A c8rx3m…
##  8 &quot;Foot pr… The lo… McKen… Nort… Winter Repo… 2004-02-26   8130 Class B c8qyyr…
##  9 &quot;The fol… Georgi… Sarpy… Nebr… Summer Repo… 2005-01-06   7809 Class A 9z7f40…
## 10 &quot;We live… (Locat… Dougl… Nebr… Summer Repo… 2005-08-13  12482 Class A 9z7f97…
## # … with 962 more rows, 18 more variables: temperature_high &lt;dbl&gt;,
## #   temperature_mid &lt;dbl&gt;, temperature_low &lt;dbl&gt;, dew_point &lt;dbl&gt;,
## #   humidity &lt;dbl&gt;, cloud_cover &lt;dbl&gt;, moon_phase &lt;dbl&gt;,
## #   precip_intensity &lt;dbl&gt;, precip_probability &lt;dbl&gt;, precip_type &lt;chr&gt;,
## #   pressure &lt;dbl&gt;, summary &lt;chr&gt;, uv_index &lt;dbl&gt;, visibility &lt;dbl&gt;,
## #   wind_bearing &lt;dbl&gt;, wind_speed &lt;dbl&gt;, year &lt;dbl&gt;, geometry &lt;POINT [m]&gt;, and
## #   abbreviated variable names ¹​location_details, ²​classification</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">ggplot</span>(sasquatch, <span class="kw">aes</span>(<span class="dt">x =</span> date)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">150</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Frequency of Sasquatch sightings&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="docs_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">ggplot</span>(sasquatch) <span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="st">  </span><span class="kw">coord_sf</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> us, <span class="dt">fill =</span> <span class="ot">NA</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="st">  </span><span class="kw">theme_classic</span>()</a></code></pre></div>
<p><img src="docs_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
<div id="nz_earthquakes" class="section level3 unnumbered hasAnchor">
<h3><code>nz_earthquakes</code><a href="data.html#nz_earthquakes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="http://quakesearch.geonet.org.nz/">GeoNet Quake Search</a> catalogues New Zealand earthquake occurrence; some of these data have been and packaged in <code>stelfi</code> as <code>nz_earthquakes</code>. In <a href="hawkes.html#hawkes">this chapter</a> a Hawkes process is fitted to these data.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">data</span>(<span class="st">&quot;nz_earthquakes&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;stelfi&quot;</span>)</a>
<a class="sourceLine" id="cb17-2" title="2">nz_earthquakes</a></code></pre></div>
<pre><code>## Simple feature collection with 3824 features and 3 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 169.83 ymin: -44.86892 xmax: 175.6328 ymax: -41.8628
## CRS:           +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
## First 10 features:
##             origintime magnitude     depth                   geometry
## 1  2014-12-24 07:46:00  3.208996 13.671875 POINT (172.7133 -43.57944)
## 2  2014-12-24 06:43:00  4.109075  5.820312 POINT (172.7204 -43.55752)
## 3  2014-12-14 08:53:00  3.240377  5.058594 POINT (172.3641 -43.62563)
## 4  2014-12-12 13:37:00  4.459034  9.394531  POINT (172.368 -43.63492)
## 5  2014-11-20 08:24:00  3.116447 10.039062 POINT (172.7836 -43.42493)
## 6  2014-11-18 14:19:00  3.158710 11.269531  POINT (172.7936 -43.4897)
## 7  2014-11-02 06:45:00  3.708697 14.960938 POINT (170.2523 -44.48656)
## 8  2014-10-11 22:32:00  3.456145 39.804688 POINT (173.1383 -42.67562)
## 9  2014-10-01 20:58:00  3.106894 11.386719 POINT (172.6879 -43.49002)
## 10 2014-09-30 15:29:00  3.911931  9.335938 POINT (172.1428 -43.25048)</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">ggplot</span>(nz_earthquakes, <span class="kw">aes</span>(<span class="dt">x =</span> origintime)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">100</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Frequency of earthquakes&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="docs_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">ggplot</span>(nz_earthquakes) <span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb20-2" title="2"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-3" title="3"><span class="st">  </span><span class="kw">coord_sf</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-4" title="4"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> nz, <span class="dt">fill =</span> <span class="ot">NA</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-5" title="5"><span class="st">  </span><span class="kw">theme_classic</span>()</a></code></pre></div>
<p><img src="docs_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
<div id="nz_murders" class="section level3 unnumbered hasAnchor">
<h3><code>nz_murders</code><a href="data.html#nz_murders" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://interactives.stuff.co.nz/2019/the-homicide-report/">The Homicide Report</a> documents homicides in New Zealand. The <code>nz_murders</code> dataset contains summary information about the documented cases. In <a href="hawkes.html#hawkes">this chapter</a> a spatiotemporal self-exciting model is fitted to these data.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">data</span>(<span class="st">&quot;nz_murders&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;stelfi&quot;</span>)</a>
<a class="sourceLine" id="cb21-2" title="2">nz_murders</a></code></pre></div>
<pre><code>## Simple feature collection with 967 features and 11 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 167.9161 ymin: -46.96127 xmax: 178.3955 ymax: -34.54022
## CRS:           +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
## First 10 features:
##       sex age   date year                      cause              killer
## 1    Male  41  Jan 5 2004                   stabbing              friend
## 2    Male  46  Jan 8 2004            pick axe wounds              friend
## 3    Male   0 Jan 15 2004 asphyxiation (suffocation)              mother
## 4  Female  46  Feb 1 2004         blunt force trauma             partner
## 5    Male  10  Feb 2 2004                   stabbing              father
## 6  Female   2  Feb 2 2004                   stabbing              father
## 7    Male  36  Feb 4 2004                   stabbing partners ex-partner
## 8    Male  20  Feb 8 2004                  car crash              friend
## 9    Male  29  Feb 8 2004         blunt force trauma           strangers
## 10 Female  32 Feb 15 2004         blunt force trauma             husband
##                       name  full_date    month          cause_cat     region
## 1           Donald Linwood 2004-01-05  January     Violent weapon Canterbury
## 2              James Weeks 2004-01-08  January     Violent weapon Canterbury
## 3  Gabriel Harrison-Taylor 2004-01-15  January           Asphyxia   Auckland
## 4    Odette Lloyd-Rangiuia 2004-02-01 February Blunt force trauma Canterbury
## 5          Te Hau OCarroll 2004-02-02 February     Violent weapon Wellington
## 6         Ngamata OCarroll 2004-02-02 February     Violent weapon Wellington
## 7          Darryn McRobert 2004-02-04 February     Violent weapon Canterbury
## 8           Peretiso Sauni 2004-02-08 February          Car crash   Auckland
## 9           Shannon McComb 2004-02-08 February Blunt force trauma Canterbury
## 10        Asolelei Sameulu 2004-02-15 February Blunt force trauma   Auckland
##                      geometry
## 1  POINT (171.6442 -43.63394)
## 2  POINT (172.1305 -43.28563)
## 3  POINT (174.8498 -36.92575)
## 4  POINT (172.6327 -43.55006)
## 5  POINT (175.1195 -40.73297)
## 6  POINT (175.1193 -40.73273)
## 7  POINT (172.5172 -43.53866)
## 8  POINT (174.7335 -36.89708)
## 9  POINT (172.6429 -43.54363)
## 10 POINT (174.6274 -36.90353)</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">ggplot</span>(nz_murders, <span class="kw">aes</span>(<span class="dt">x =</span> full_date)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">100</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Frequency of murders&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-3" title="3"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="docs_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
</div>
<div id="iraq_terrorism" class="section level3 unnumbered hasAnchor">
<h3><code>iraq_terrorism</code><a href="data.html#iraq_terrorism" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="http://www.start.umd.edu/gtd/">The Global Terrorism Database (GTD)</a> documents information on terrorism events worldwide; some of these data have been and packaged in <code>stelfi</code> as <code>iraq_terrorism</code>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">data</span>(<span class="st">&quot;iraq_terrorism&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;stelfi&quot;</span>)</a>
<a class="sourceLine" id="cb24-2" title="2">iraq_terrorism</a></code></pre></div>
<pre><code>## Simple feature collection with 4208 features and 16 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 38.92288 ymin: 30.51005 xmax: 47.7781 ymax: 36.92948
## CRS:           +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
## First 10 features:
##       iyear imonth iday country success nkill specificity
## 18055  2013      4   18    Iraq    TRUE    28           1
## 18109  2013      4   20    Iraq    TRUE     0           1
## 18110  2013      4   20    Iraq    TRUE     0           1
## 18111  2013      4   20    Iraq    TRUE     0           1
## 18864  2013      5   16    Iraq    TRUE     3           1
## 18865  2013      5   16    Iraq    TRUE     3           1
## 18866  2013      5   16    Iraq    TRUE     2           1
## 18867  2013      5   16    Iraq    TRUE     3           1
## 19161  2013      5   27    Iraq    TRUE     6           1
## 19166  2013      5   27    Iraq    TRUE     1           1
##                                             gname   x_coord   y_coord   z_coord
## 18055 Islamic State of Iraq and the Levant (ISIL) 0.5974251 0.5844656 0.5490748
## 18109 Islamic State of Iraq and the Levant (ISIL) 0.5997164 0.5864987 0.5443892
## 18110 Islamic State of Iraq and the Levant (ISIL) 0.5992751 0.5859289 0.5454876
## 18111 Islamic State of Iraq and the Levant (ISIL) 0.5959873 0.5733453 0.5622049
## 18864 Islamic State of Iraq and the Levant (ISIL) 0.5974251 0.5844656 0.5490748
## 18865 Islamic State of Iraq and the Levant (ISIL) 0.5974251 0.5844656 0.5490748
## 18866 Islamic State of Iraq and the Levant (ISIL) 0.5974251 0.5844656 0.5490748
## 18867 Islamic State of Iraq and the Levant (ISIL) 0.5876310 0.5507342 0.5927745
## 19161 Islamic State of Iraq and the Levant (ISIL) 0.5974251 0.5844656 0.5490748
## 19166 Islamic State of Iraq and the Levant (ISIL) 0.5974251 0.5844656 0.5490748
##       popdensity luminosity         tt    utm_x      utm_y
## 18055  0.4065874  1.0924644 -0.3210921 333098.1 4007920.00
## 18109 -0.3479151  0.2298066 -0.2726546 407264.8 5332968.87
## 18110 -0.3479432  0.9717434 -0.3210921 401682.9 5252649.56
## 18111 -0.3783331  1.0521158 -0.3210921 405272.2 5344797.97
## 18864  0.4065874  1.0924644 -0.3210921 595450.3 4078540.46
## 18865  0.4065874  1.0924644 -0.3210921 595450.3 4078540.46
## 18866  0.4065874  1.0924644 -0.3210921 723492.7   45579.28
## 18867 -0.3665068  1.0924644 -0.3210921 815931.5  435892.29
## 19161  0.4065874  1.0924644 -0.3210921 252226.3 3703963.04
## 19166  0.4065874  1.0924644 -0.3210921 756886.0 4023175.15
##                        geometry
## 18055 POINT (44.37177 33.30357)
## 18109  POINT (44.3616 32.98293)
## 18110 POINT (44.35484 33.05799)
## 18111 POINT (43.89071 34.20842)
## 18864 POINT (44.37177 33.30357)
## 18865 POINT (44.37177 33.30357)
## 18866 POINT (44.37177 33.30357)
## 18867 POINT (43.14357 36.35415)
## 19161 POINT (44.37177 33.30357)
## 19166 POINT (44.37177 33.30357)</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">iraq_terrorism <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">date =</span> <span class="kw">paste</span>(iday, imonth, iyear, <span class="dt">sep =</span> <span class="st">&quot;/&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb26-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">date =</span> <span class="kw">as.Date</span>(date, <span class="st">&quot;%d/%m/%Y&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb26-4" title="4"><span class="st">  </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x =</span> date)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">150</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-5" title="5"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Frequency of attacks&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-6" title="6"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="docs_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">ggplot</span>(iraq_terrorism) <span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="st">  </span><span class="kw">coord_sf</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-4" title="4"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> iraq, <span class="dt">fill =</span> <span class="ot">NA</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb27-5" title="5"><span class="st">  </span><span class="kw">theme_classic</span>()</a></code></pre></div>
<p><img src="docs_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
</div>
<div id="simulated-data" class="section level2 hasAnchor">
<h2><span class="header-section-number">1.3</span> Simulated data<a href="data.html#simulated-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="xyt" class="section level3 unnumbered hasAnchor">
<h3><code>xyt</code><a href="data.html#xyt" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In <a href="lgcp.html#lgcp">this chapter</a> a log-Gaussian Cox process is fitted to these data and in <a href="stelfi.html#stelfi">this chapter</a> a spatiotemporal selfexciting model is fitted.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">data</span>(<span class="st">&quot;xyt&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;stelfi&quot;</span>)</a>
<a class="sourceLine" id="cb28-2" title="2">xyt_sf &lt;-<span class="st"> </span>sf<span class="op">::</span><span class="kw">st_as_sf</span>(xyt)</a>
<a class="sourceLine" id="cb28-3" title="3">xyt_sf</a></code></pre></div>
<pre><code>## Simple feature collection with 654 features and 1 field
## Geometry type: GEOMETRY
## Dimension:     XY
## Bounding box:  xmin: 0 ymin: -2.974928 xmax: 12.56637 ymax: 2.974928
## CRS:           NA
## First 10 features:
##     label                           geom
## 1  window POLYGON ((10.77117 -2.78183...
## 2   point       POINT (6.8074 -2.034423)
## 3   point     POINT (7.558362 -2.193865)
## 4   point     POINT (8.085083 -2.080938)
## 5   point     POINT (8.121308 -2.522357)
## 6   point     POINT (8.362448 -2.303117)
## 7   point     POINT (9.000749 -2.955328)
## 8   point     POINT (9.147803 -2.243146)
## 9   point     POINT (9.261744 -2.408326)
## 10  point      POINT (8.532312 -2.48986)</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">ggplot</span>(xyt_sf) <span class="op">+</span><span class="st"> </span><span class="kw">geom_sf</span>(<span class="dt">fill =</span> <span class="ot">NA</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-2" title="2"><span class="st">  </span><span class="kw">theme_void</span>()</a></code></pre></div>
<p><img src="docs_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
</div>
<div id="marked" class="section level3 unnumbered hasAnchor">
<h3><code>marked</code><a href="data.html#marked" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In <a href="fit-marked.html#fit-marked">this chapter</a> a marked log-Gaussian Cox process is fitted to these data.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">data</span>(marked, <span class="dt">package =</span> <span class="st">&quot;stelfi&quot;</span>)</a>
<a class="sourceLine" id="cb31-2" title="2">marked_sf &lt;-<span class="st"> </span>sf<span class="op">::</span><span class="kw">st_as_sf</span>(<span class="dt">x =</span> marked,</a>
<a class="sourceLine" id="cb31-3" title="3">                        <span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>))</a>
<a class="sourceLine" id="cb31-4" title="4">marked_sf</a></code></pre></div>
<pre><code>## Simple feature collection with 159 features and 3 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 0.006606752 ymin: 0.006502493 xmax: 2.985087 ymax: 2.938558
## CRS:           NA
## First 10 features:
##           m1 m2        m3                     geometry
## 1  10.008609  0  9.616468 POINT (0.08935799 0.5756269)
## 2   8.730592  0  6.918024     POINT (2.177973 2.90455)
## 3  11.330677  0 16.798212    POINT (2.250791 1.024792)
## 4  11.338656  0  8.073566    POINT (2.033398 1.038773)
## 5   9.395725  0  9.977866   POINT (2.777002 0.4685442)
## 6  10.331965  0 10.615245   POINT (0.5988652 2.422233)
## 7  10.069787  0 11.268171   POINT (1.541071 0.9307671)
## 8   9.717775  0 13.306125    POINT (2.615062 1.064561)
## 9  10.071326  0 18.300715   POINT (0.3882139 2.146845)
## 10 10.147740  0 16.751740     POINT (1.501552 1.64466)</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">domain &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="kw">cbind</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb33-2" title="2"><span class="st">  </span>sf<span class="op">::</span><span class="kw">st_polygon</span>() <span class="op">%&gt;%</span><span class="st"> </span>sf<span class="op">::</span><span class="kw">st_sfc</span>() <span class="op">%&gt;%</span><span class="st"> </span>sf<span class="op">::</span><span class="kw">st_sf</span>(<span class="dt">geometry =</span> .)</a>
<a class="sourceLine" id="cb33-3" title="3"></a>
<a class="sourceLine" id="cb33-4" title="4"><span class="kw">ggplot</span>(marked_sf, <span class="kw">aes</span>(<span class="dt">col =</span> m1)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-5" title="5"><span class="st">  </span><span class="kw">geom_sf</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">color =</span> <span class="st">&quot;Mark&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-6" title="6"><span class="st">  </span><span class="kw">scale_color_continuous</span>(<span class="dt">type =</span> <span class="st">&quot;viridis&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-7" title="7"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> domain, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">inherit.aes =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-8" title="8"><span class="st">  </span><span class="kw">theme_void</span>()</a></code></pre></div>
<p><img src="docs_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
</div>
<div id="horse_mesh" class="section level3 unnumbered hasAnchor">
<h3><code>horse_mesh</code><a href="data.html#horse_mesh" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In <a href="meshmetrics.html#meshmetrics">this chapter</a> we illustrate different geometric metrics of this triangulation.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="kw">data</span>(<span class="st">&quot;horse_mesh&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;stelfi&quot;</span>)</a>
<a class="sourceLine" id="cb34-2" title="2">horse_mesh_sf &lt;-<span class="st"> </span>stelfi<span class="op">::</span><span class="kw">mesh_2_sf</span>(horse_mesh)</a>
<a class="sourceLine" id="cb34-3" title="3">horse_mesh_sf</a></code></pre></div>
<pre><code>## Simple feature collection with 396 features and 4 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: -17.96875 ymin: -11.78261 xmax: 17.26563 ymax: 11.65217
## CRS:           NA
## First 10 features:
##     V1  V2  V3 ID                       geometry
## 1  172  30 186  1 POLYGON ((8.441837 -2.16176...
## 2   28 188 162  2 POLYGON ((10.43359 0.913043...
## 3  168 186  42  3 POLYGON ((5.818232 -3.05894...
## 4  117  57  63  4 POLYGON ((-3.660156 -8.0326...
## 5  270 253 121  5 POLYGON ((-8.43636 2.023352...
## 6   92 144 169  6 POLYGON ((-8.042969 4.47826...
## 7  175 137 240  7 POLYGON ((5.689521 -1.13385...
## 8  182 148 111  8 POLYGON ((10.50244 7.199319...
## 9  253 169 121  9 POLYGON ((-7.850425 2.87106...
## 10  14  15 116 10 POLYGON ((13.3125 11.56522,...</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="kw">ggplot</span>(horse_mesh_sf) <span class="op">+</span><span class="st"> </span><span class="kw">geom_sf</span>(<span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb36-2" title="2"><span class="st">  </span><span class="kw">theme_void</span>()</a></code></pre></div>
<p><img src="docs_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="key-stelfi-functions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["docs.pdf", "docs.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
